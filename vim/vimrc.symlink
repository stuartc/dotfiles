set nocompatible               " be iMproved
filetype off                   " required!

set encoding=utf-8
" Might not need this, if the env correctly sets $TERM
"set t_Co=256

set rtp+=~/.vim/bundle/Vundle.vim
call vundle#begin()

" let Vundle manage Vundle
" required! 
Bundle 'gmarik/vundle'

Bundle 'altercation/vim-colors-solarized'
Bundle 'chriskempson/tomorrow-theme', {'rtp': 'vim/'}
Bundle 'tpope/vim-markdown'
Bundle "scrooloose/nerdtree"
Bundle 'scrooloose/nerdcommenter'
Bundle 'kien/ctrlp.vim'
Bundle 'FelikZ/ctrlp-py-matcher'
Bundle 'vim-ruby/vim-ruby'
Bundle 'tpope/vim-endwise'
"Bundle 'pangloss/vim-javascript'
Bundle 'jelera/vim-javascript-syntax'
Bundle 'mxw/vim-jsx'
Bundle 'jiangmiao/auto-pairs'
Bundle 'taglist.vim'
Bundle 'kchmck/vim-coffee-script'
Bundle 'mtscout6/vim-cjsx'
Bundle 'nono/vim-handlebars'
Bundle 'jeetsukumaran/vim-buffergator'
Bundle 'rking/ag.vim'
Bundle 'cakebaker/scss-syntax.vim'
Bundle 'groenewege/vim-less'

" Auto completeness
Bundle "MarcWeber/vim-addon-mw-utils"
Bundle "tomtom/tlib_vim"
Bundle "garbas/vim-snipmate"
Bundle "honza/vim-snippets"
Bundle "tpope/vim-surround"

" git
Bundle 'tpope/vim-fugitive'
Bundle 'airblade/vim-gitgutter'

Bundle "ervandew/supertab"

Bundle 'bling/vim-airline'

call vundle#end()

" Pretty line
set laststatus=2
let g:airline_theme='badwolf'
let g:airline_powerline_fonts=1  

" Do JSX formatting for .js files as well.
let g:jsx_ext_required = 0

let g:ctrlp_user_command = 'ag %s -i --nocolor --nogroup --hidden
  \ --ignore .git
  \ --ignore .svn
  \ --ignore .hg
  \ --ignore .DS_Store
  \ --ignore "**/*.pyc"
  \ -g ""'


syntax enable
filetype plugin indent on     " required!

" Tomorrow Night Theme
colorscheme Tomorrow-Night-Eighties

" Default indent settings
set shiftwidth=2
set softtabstop=2
set expandtab
set autoindent

let NERDSpaceDelims=1

" line numbers
set number
set cursorline
set colorcolumn=81

" No folding for markdown
let g:vim_markdown_folding_disabled=1
" Markdown
let g:markdown_fenced_languages = ['coffee', 'css', 'erb=eruby', 'javascript', 'js=javascript', 'json=javascript', 'ruby', 'sass', 'xml']

" Commenting
map <leader>/ <plug>NERDCommenterToggle<CR>
imap <leader>/ <Esc><plug>NERDCommenterToggle<CR>i


" CTags
" Look for hidden tags file
set tags=./.tags,.tags
nnoremap <leader>. :CtrlPTag<cr>

" Create the parent path for a new file.
" :e spec/models/namespace/obj_spec.rb
" <leader>mkpd => `mkdir -p spec/models/namespace`
nmap <leader>mkpd :call MakeParentDirectory()<CR>
function! MakeParentDirectory()
  exec "!mkdir -p %:h" 
  echom 'Created parent directory: ' . expand('%:h')
endfunction

" Highlight searches
map <leader>hs <Esc>:set hlsearch!<CR>

" Nerdtree should open even if no file was specified
" autocmd vimenter * if !argc() | NERDTree | endif
map <leader>n :NERDTreeToggle<CR>

" Git/Fugitive
nmap <leader>gs :Gstatus<CR>
nmap <leader>gd :Gdiff<CR>
nmap <leader>gb :Gblame<CR>

nmap <Leader>ha <Plug>GitGutterStageHunk
nmap <Leader>hu <Plug>GitGutterRevertHunk


" Ag
map <leader>ag :Ag 

map <leader>R! :so $MYVIMRC<CR>

" Avoid using Esc
imap jj <Esc>

" Learn to use h,j,k,l!
noremap <Up> <NOP>
noremap <Down> <NOP>
noremap <Left> <NOP>
noremap <Right> <NOP>

" Ctrl-j/k deletes blank line below/above, and Alt-j/k inserts.
" http://vim.wikia.com/wiki/Quickly_adding_and_deleting_empty_lines
nnoremap <silent><C-j> m`:silent +g/\m^\s*$/d<CR>``:noh<CR>
nnoremap <silent><C-k> m`:silent -g/\m^\s*$/d<CR>``:noh<CR>
nnoremap <silent><A-j> :set paste<CR>m`o<Esc>``:set nopaste<CR>
nnoremap <silent>∆ :set paste<CR>m`o<Esc>``:set nopaste<CR>
nnoremap <silent>˚ :set paste<CR>m`O<Esc>``:set nopaste<CR>

" MacVim stuff
set guifont=Droid\ Sans\ Mono\ for\ Powerline:h14

" Remove the scroll bars
" and native window tab bar
" So no eLr etc.
set guioptions=gm

#!/bin/bash
# Generated by chezmoi - do not edit directly
{{- if hasKey . "raycast_projects" }}
# Hash: {{ .raycast_projects | toJson | sha256sum }}

SCRIPTS_DIR="$HOME/.raycast/scripts/projects"
mkdir -p "$SCRIPTS_DIR"

# Track generated scripts
GENERATED_SCRIPTS=()

{{ range .raycast_projects -}}
SCRIPT_NAME="open-{{ .name | lower | replace " " "-" }}.sh"
cat > "$SCRIPTS_DIR/$SCRIPT_NAME" << 'SCRIPT'
#!/bin/bash
# @raycast.schemaVersion 1
# @raycast.title Open {{ .name }}
# @raycast.mode silent
# @raycast.packageName Projects

# Extend PATH for VS Code to find language servers and tools
# Add common locations without the overhead of loading full shell
export PATH="$HOME/.bin:$HOME/.asdf/shims:/opt/homebrew/bin:/usr/local/bin:$PATH"

# Debug: Uncomment to enable logging to ~/.vscode-open.log (see RAYCAST.md)
# exec "$HOME/.bin/vscode-open" --debug {{ .path }} "{{ .name }}"
exec "$HOME/.bin/vscode-open" {{ .path }} "{{ .name }}"
SCRIPT
chmod +x "$SCRIPTS_DIR/$SCRIPT_NAME"
GENERATED_SCRIPTS+=("$SCRIPT_NAME")
{{ end -}}

# Clean up scripts that are no longer in the project list
if [ -d "$SCRIPTS_DIR" ]; then
    for script in "$SCRIPTS_DIR"/open-*.sh; do
        if [ -f "$script" ]; then
            script_name=$(basename "$script")
            if [[ ! " ${GENERATED_SCRIPTS[@]} " =~ " ${script_name} " ]]; then
                echo "Removing obsolete script: $script_name"
                rm "$script"
            fi
        fi
    done
fi
{{- else }}
# No raycast_projects defined - skipping script generation
{{- end }}
